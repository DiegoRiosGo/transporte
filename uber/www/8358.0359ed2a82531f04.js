"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8358],{6854:(Z,v,l)=>{l.d(v,{I:()=>d,T:()=>g});var L=l(5861),C=l(8177);class d{constructor(h){this.southwest=h.southwest,this.center=h.center,this.northeast=h.northeast}contains(h){var c=this;return(0,L.Z)(function*(){return(yield C.S.mapBoundsContains({bounds:c,point:h})).contains})()}extend(h){var c=this;return(0,L.Z)(function*(){const o=yield C.S.mapBoundsExtend({bounds:c,point:h});return c.southwest=o.bounds.southwest,c.center=o.bounds.center,c.northeast=o.bounds.northeast,c})()}}var g=function(r){return r.Normal="Normal",r.Hybrid="Hybrid",r.Satellite="Satellite",r.Terrain="Terrain",r.None="None",r}(g||{})},8177:(Z,v,l)=>{l.d(v,{S:()=>C});const C=(0,l(2726).fo)("CapacitorGoogleMaps",{web:()=>l.e(4059).then(l.bind(l,4059)).then(d=>new d.CapacitorGoogleMapsWeb)});C.addListener("isMapInFocus",d=>{var g;const c=document.elementFromPoint(d.x,d.y),P=(null===(g=null==c?void 0:c.dataset)||void 0===g?void 0:g.internalId)===d.mapId;C.dispatchMapEvent({id:d.mapId,focus:P})})},8358:(Z,v,l)=>{l.r(v),l.d(v,{MapaPageModule:()=>W});var L=l(6814),C=l(95),d=l(9004),g=l(3044),r=l(5861),h=l(6854),c=l(2726),o=l(8177);class P extends HTMLElement{constructor(){super()}connectedCallback(){if(this.innerHTML="","ios"==c.dV.getPlatform()){this.style.overflow="scroll",this.style["-webkit-overflow-scrolling"]="touch";const e=document.createElement("div");e.style.height="200%",this.appendChild(e)}}}customElements.define("capacitor-google-map",P);class p{constructor(e){this.element=null,this.resizeObserver=null,this.handleScrollEvent=()=>this.updateMapBounds(),this.id=e}static create(e,n){return(0,r.Z)(function*(){const i=new p(e.id);if(!e.element)throw new Error("container element is required");void 0===e.config.androidLiteMode&&(e.config.androidLiteMode=!1),i.element=e.element,i.element.dataset.internalId=e.id;const a=yield p.getElementBounds(e.element);if(e.config.width=a.width,e.config.height=a.height,e.config.x=a.x,e.config.y=a.y,e.config.devicePixelRatio=window.devicePixelRatio,"android"==c.dV.getPlatform()&&i.initScrolling(),c.dV.isNativePlatform()){e.element={};const u=()=>{var m,k;const S=null!==(k=null===(m=i.element)||void 0===m?void 0:m.getBoundingClientRect())&&void 0!==k?k:{};return{x:S.x,y:S.y,width:S.width,height:S.height}},f=()=>{o.S.onDisplay({id:i.id,mapBounds:u()})},_=()=>{o.S.onResize({id:i.id,mapBounds:u()})},y=i.element.closest(".ion-page");"ios"===c.dV.getPlatform()&&y&&(y.addEventListener("ionViewWillEnter",()=>{setTimeout(()=>{f()},100)}),y.addEventListener("ionViewDidEnter",()=>{setTimeout(()=>{f()},100)}));const M={width:a.width,height:a.height,isHidden:!1};i.resizeObserver=new ResizeObserver(()=>{if(null!=i.element){const m=i.element.getBoundingClientRect(),k=0===m.width&&0===m.height;k||(M.isHidden?"ios"===c.dV.getPlatform()&&!y&&f():(M.width!==m.width||M.height!==m.height)&&_()),M.width=m.width,M.height=m.height,M.isHidden=k}}),i.resizeObserver.observe(i.element)}if(yield new Promise((u,f)=>{setTimeout((0,r.Z)(function*(){try{yield o.S.create(e),u(void 0)}catch(_){f(_)}}),200)}),n){const u=yield o.S.addListener("onMapReady",f=>{f.mapId==i.id&&(n(f),u.remove())})}return i})()}static getElementBounds(e){return(0,r.Z)(function*(){return new Promise(n=>{let i=e.getBoundingClientRect();if(0==i.width){let a=0;const u=setInterval(function(){0==i.width&&a<30?(i=e.getBoundingClientRect(),a++):(30==a&&console.warn("Map size could not be determined"),clearInterval(u),n(i))},100)}else n(i)})})()}enableTouch(){var e=this;return(0,r.Z)(function*(){return o.S.enableTouch({id:e.id})})()}disableTouch(){var e=this;return(0,r.Z)(function*(){return o.S.disableTouch({id:e.id})})()}enableClustering(e){var n=this;return(0,r.Z)(function*(){return o.S.enableClustering({id:n.id,minClusterSize:e})})()}disableClustering(){var e=this;return(0,r.Z)(function*(){return o.S.disableClustering({id:e.id})})()}addMarker(e){var n=this;return(0,r.Z)(function*(){return(yield o.S.addMarker({id:n.id,marker:e})).id})()}addMarkers(e){var n=this;return(0,r.Z)(function*(){return(yield o.S.addMarkers({id:n.id,markers:e})).ids})()}removeMarker(e){var n=this;return(0,r.Z)(function*(){return o.S.removeMarker({id:n.id,markerId:e})})()}removeMarkers(e){var n=this;return(0,r.Z)(function*(){return o.S.removeMarkers({id:n.id,markerIds:e})})()}addPolygons(e){var n=this;return(0,r.Z)(function*(){return(yield o.S.addPolygons({id:n.id,polygons:e})).ids})()}addPolylines(e){var n=this;return(0,r.Z)(function*(){return(yield o.S.addPolylines({id:n.id,polylines:e})).ids})()}removePolygons(e){var n=this;return(0,r.Z)(function*(){return o.S.removePolygons({id:n.id,polygonIds:e})})()}addCircles(e){var n=this;return(0,r.Z)(function*(){return(yield o.S.addCircles({id:n.id,circles:e})).ids})()}removeCircles(e){var n=this;return(0,r.Z)(function*(){return o.S.removeCircles({id:n.id,circleIds:e})})()}removePolylines(e){var n=this;return(0,r.Z)(function*(){return o.S.removePolylines({id:n.id,polylineIds:e})})()}destroy(){var e=this;return(0,r.Z)(function*(){var n;return"android"==c.dV.getPlatform()&&e.disableScrolling(),c.dV.isNativePlatform()&&(null===(n=e.resizeObserver)||void 0===n||n.disconnect()),e.removeAllMapListeners(),o.S.destroy({id:e.id})})()}setCamera(e){var n=this;return(0,r.Z)(function*(){return o.S.setCamera({id:n.id,config:e})})()}getMapType(){var e=this;return(0,r.Z)(function*(){const{type:n}=yield o.S.getMapType({id:e.id});return h.T[n]})()}setMapType(e){var n=this;return(0,r.Z)(function*(){return o.S.setMapType({id:n.id,mapType:e})})()}enableIndoorMaps(e){var n=this;return(0,r.Z)(function*(){return o.S.enableIndoorMaps({id:n.id,enabled:e})})()}enableTrafficLayer(e){var n=this;return(0,r.Z)(function*(){return o.S.enableTrafficLayer({id:n.id,enabled:e})})()}enableAccessibilityElements(e){var n=this;return(0,r.Z)(function*(){return o.S.enableAccessibilityElements({id:n.id,enabled:e})})()}enableCurrentLocation(e){var n=this;return(0,r.Z)(function*(){return o.S.enableCurrentLocation({id:n.id,enabled:e})})()}setPadding(e){var n=this;return(0,r.Z)(function*(){return o.S.setPadding({id:n.id,padding:e})})()}getMapBounds(){var e=this;return(0,r.Z)(function*(){return new h.I(yield o.S.getMapBounds({id:e.id}))})()}fitBounds(e,n){var i=this;return(0,r.Z)(function*(){return o.S.fitBounds({id:i.id,bounds:e,padding:n})})()}initScrolling(){const e=document.getElementsByTagName("ion-content");for(let n=0;n<e.length;n++)e[n].scrollEvents=!0;window.addEventListener("ionScroll",this.handleScrollEvent),window.addEventListener("scroll",this.handleScrollEvent),window.addEventListener("resize",this.handleScrollEvent),screen.orientation?screen.orientation.addEventListener("change",()=>{setTimeout(this.updateMapBounds,500)}):window.addEventListener("orientationchange",()=>{setTimeout(this.updateMapBounds,500)})}disableScrolling(){window.removeEventListener("ionScroll",this.handleScrollEvent),window.removeEventListener("scroll",this.handleScrollEvent),window.removeEventListener("resize",this.handleScrollEvent),screen.orientation?screen.orientation.removeEventListener("change",()=>{setTimeout(this.updateMapBounds,1e3)}):window.removeEventListener("orientationchange",()=>{setTimeout(this.updateMapBounds,1e3)})}updateMapBounds(){if(this.element){const e=this.element.getBoundingClientRect();o.S.onScroll({id:this.id,mapBounds:{x:e.x,y:e.y,width:e.width,height:e.height}})}}setOnCameraIdleListener(e){var n=this;return(0,r.Z)(function*(){n.onCameraIdleListener&&n.onCameraIdleListener.remove(),n.onCameraIdleListener=e?yield o.S.addListener("onCameraIdle",n.generateCallback(e)):void 0})()}setOnBoundsChangedListener(e){var n=this;return(0,r.Z)(function*(){n.onBoundsChangedListener&&n.onBoundsChangedListener.remove(),n.onBoundsChangedListener=e?yield o.S.addListener("onBoundsChanged",n.generateCallback(e)):void 0})()}setOnCameraMoveStartedListener(e){var n=this;return(0,r.Z)(function*(){n.onCameraMoveStartedListener&&n.onCameraMoveStartedListener.remove(),n.onCameraMoveStartedListener=e?yield o.S.addListener("onCameraMoveStarted",n.generateCallback(e)):void 0})()}setOnClusterClickListener(e){var n=this;return(0,r.Z)(function*(){n.onClusterClickListener&&n.onClusterClickListener.remove(),n.onClusterClickListener=e?yield o.S.addListener("onClusterClick",n.generateCallback(e)):void 0})()}setOnClusterInfoWindowClickListener(e){var n=this;return(0,r.Z)(function*(){n.onClusterInfoWindowClickListener&&n.onClusterInfoWindowClickListener.remove(),n.onClusterInfoWindowClickListener=e?yield o.S.addListener("onClusterInfoWindowClick",n.generateCallback(e)):void 0})()}setOnInfoWindowClickListener(e){var n=this;return(0,r.Z)(function*(){n.onInfoWindowClickListener&&n.onInfoWindowClickListener.remove(),n.onInfoWindowClickListener=e?yield o.S.addListener("onInfoWindowClick",n.generateCallback(e)):void 0})()}setOnMapClickListener(e){var n=this;return(0,r.Z)(function*(){n.onMapClickListener&&n.onMapClickListener.remove(),n.onMapClickListener=e?yield o.S.addListener("onMapClick",n.generateCallback(e)):void 0})()}setOnPolygonClickListener(e){var n=this;return(0,r.Z)(function*(){n.onPolygonClickListener&&n.onPolygonClickListener.remove(),n.onPolygonClickListener=e?yield o.S.addListener("onPolygonClick",n.generateCallback(e)):void 0})()}setOnCircleClickListener(e){var n=this;return(0,r.Z)(function*(){n.onCircleClickListener&&n.onCircleClickListener.remove(),n.onCircleClickListener=e?yield o.S.addListener("onCircleClick",n.generateCallback(e)):void 0})()}setOnMarkerClickListener(e){var n=this;return(0,r.Z)(function*(){n.onMarkerClickListener&&n.onMarkerClickListener.remove(),n.onMarkerClickListener=e?yield o.S.addListener("onMarkerClick",n.generateCallback(e)):void 0})()}setOnPolylineClickListener(e){var n=this;return(0,r.Z)(function*(){n.onPolylineClickListener&&n.onPolylineClickListener.remove(),n.onPolylineClickListener=e?yield o.S.addListener("onPolylineClick",n.generateCallback(e)):void 0})()}setOnMarkerDragStartListener(e){var n=this;return(0,r.Z)(function*(){n.onMarkerDragStartListener&&n.onMarkerDragStartListener.remove(),n.onMarkerDragStartListener=e?yield o.S.addListener("onMarkerDragStart",n.generateCallback(e)):void 0})()}setOnMarkerDragListener(e){var n=this;return(0,r.Z)(function*(){n.onMarkerDragListener&&n.onMarkerDragListener.remove(),n.onMarkerDragListener=e?yield o.S.addListener("onMarkerDrag",n.generateCallback(e)):void 0})()}setOnMarkerDragEndListener(e){var n=this;return(0,r.Z)(function*(){n.onMarkerDragEndListener&&n.onMarkerDragEndListener.remove(),n.onMarkerDragEndListener=e?yield o.S.addListener("onMarkerDragEnd",n.generateCallback(e)):void 0})()}setOnMyLocationButtonClickListener(e){var n=this;return(0,r.Z)(function*(){n.onMyLocationButtonClickListener&&n.onMyLocationButtonClickListener.remove(),n.onMyLocationButtonClickListener=e?yield o.S.addListener("onMyLocationButtonClick",n.generateCallback(e)):void 0})()}setOnMyLocationClickListener(e){var n=this;return(0,r.Z)(function*(){n.onMyLocationClickListener&&n.onMyLocationClickListener.remove(),n.onMyLocationClickListener=e?yield o.S.addListener("onMyLocationClick",n.generateCallback(e)):void 0})()}removeAllMapListeners(){var e=this;return(0,r.Z)(function*(){e.onBoundsChangedListener&&(e.onBoundsChangedListener.remove(),e.onBoundsChangedListener=void 0),e.onCameraIdleListener&&(e.onCameraIdleListener.remove(),e.onCameraIdleListener=void 0),e.onCameraMoveStartedListener&&(e.onCameraMoveStartedListener.remove(),e.onCameraMoveStartedListener=void 0),e.onClusterClickListener&&(e.onClusterClickListener.remove(),e.onClusterClickListener=void 0),e.onClusterInfoWindowClickListener&&(e.onClusterInfoWindowClickListener.remove(),e.onClusterInfoWindowClickListener=void 0),e.onInfoWindowClickListener&&(e.onInfoWindowClickListener.remove(),e.onInfoWindowClickListener=void 0),e.onMapClickListener&&(e.onMapClickListener.remove(),e.onMapClickListener=void 0),e.onPolylineClickListener&&(e.onPolylineClickListener.remove(),e.onPolylineClickListener=void 0),e.onMarkerClickListener&&(e.onMarkerClickListener.remove(),e.onMarkerClickListener=void 0),e.onPolygonClickListener&&(e.onPolygonClickListener.remove(),e.onPolygonClickListener=void 0),e.onCircleClickListener&&(e.onCircleClickListener.remove(),e.onCircleClickListener=void 0),e.onMarkerDragStartListener&&(e.onMarkerDragStartListener.remove(),e.onMarkerDragStartListener=void 0),e.onMarkerDragListener&&(e.onMarkerDragListener.remove(),e.onMarkerDragListener=void 0),e.onMarkerDragEndListener&&(e.onMarkerDragEndListener.remove(),e.onMarkerDragEndListener=void 0),e.onMyLocationButtonClickListener&&(e.onMyLocationButtonClickListener.remove(),e.onMyLocationButtonClickListener=void 0),e.onMyLocationClickListener&&(e.onMyLocationClickListener.remove(),e.onMyLocationClickListener=void 0)})()}generateCallback(e){const n=this.id;return i=>{i.mapId==n&&e(i)}}}const b=(0,c.fo)("Geolocation",{web:()=>l.e(579).then(l.bind(l,579)).then(s=>new s.GeolocationWeb)});var t=l(6689),I=l(4414),w=l(9167);const E=["map"];function B(s,e){if(1&s){const n=t.EpF();t.TgZ(0,"ion-button",12),t.NdJ("click",function(){t.CHM(n);const a=t.oxw();return t.KtG(a.calculaRuta())}),t._uU(1,"solicitar conductor"),t.qZA()}}function T(s,e){if(1&s&&(t.TgZ(0,"ion-item")(1,"ion-label"),t._uU(2),t.qZA()()),2&s){const n=e.$implicit;t.xp6(2),t.lnq("",n.nombre," ",n.apellido," - ",n.patente,"")}}function D(s,e){if(1&s&&(t.TgZ(0,"ion-list"),t.YNc(1,T,3,3,"ion-item",13),t.qZA()),2&s){const n=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",n.userconductor)}}function O(s,e){1&s&&(t.TgZ(0,"div"),t._uU(1," No hay conductores disponibles por el momento. "),t.qZA())}function R(s,e){if(1&s&&(t.TgZ(0,"ion-card")(1,"ion-card-header"),t._uU(2," Conductores "),t.qZA(),t.TgZ(3,"ion-card-content"),t.YNc(4,D,2,1,"ion-list",9),t.YNc(5,O,2,0,"div",9),t.qZA()()),2&s){const n=t.oxw();t.xp6(4),t.Q6J("ngIf",n.userconductor&&n.userconductor.length>0),t.xp6(1),t.Q6J("ngIf",!n.userconductor||0===n.userconductor.length)}}const x=[{path:"",component:(()=>{var s;class e{constructor(i,a,u,f){this.router=i,this.alertController=a,this.arouter=u,this.db=f,this.direccionDestino="",this.mostrarinfoconductor=!1,this.rolconductor=2}ionViewWillEnter(){this.createmap().then(()=>{})}ngOnInit(){this.arouter.paramMap.subscribe(i=>{var a;const u=null!==(a=i.get("usuarioid"))&&void 0!==a?a:"";this.usuarioid=parseInt(u,10)||0,console.log("Usuarioid en PerfilUsuarioPage:",this.usuarioid),this.usuarioid&&this.db.buscarUsuarioPorId(this.usuarioid).then(f=>{f&&(this.idRol=f.idrol,this.mostrarBotonCalculaRuta())}).catch(f=>{})}),this.obtenerConductores()}mostrarBotonCalculaRuta(){const i=document.getElementById("botonCalculaRuta");i&&(i.style.display=2===this.idRol?"":"none")}getCurrentPosition(){return(0,r.Z)(function*(){return(yield b.getCurrentPosition()).coords})()}createmap(){var i=this;return(0,r.Z)(function*(){const a=yield i.getCurrentPosition();i.Map=yield p.create({id:"my-cool-map",element:i.mapRef.nativeElement,apiKey:"AIzaSyD2czNyEOEJJKQETzm1PrjLqim5HuGGvX8",config:{center:{lat:a.latitude,lng:a.longitude},zoom:15},forceCreate:!0}),yield i.Map.addMarker({coordinate:{lat:a.latitude,lng:a.longitude},title:"origen"})})()}calculaRuta(){var i=this;return(0,r.Z)(function*(){""===i.direccionDestino.trim()?yield(yield i.alertController.create({header:"Alerta",message:"No se ha registrado ruta",buttons:["OK"]})).present():i.logout(),i.mostrarinfoconductor=!0})()}logout(){var i=this;return(0,r.Z)(function*(){yield(yield i.alertController.create({header:"Seguro?",message:"\xbfEst\xe1s seguro de que la direcci\xf3n es correcta?",buttons:[{text:"Cancelar",role:"cancel",cssClass:"secondary",handler:u=>{}},{text:"S\xed",handler:()=>{i.alertController.create({header:"\xc9xito",message:`SE HA REGISTRADO LA RUTA A: ${i.direccionDestino}`,buttons:["OK"]}).then(f=>{f.present()})}}]})).present()})()}guardarDatoLocal(i){return(0,r.Z)(function*(){localStorage.setItem("direccion",i)})()}obtenerConductores(){var i=this;return(0,r.Z)(function*(){const a=yield i.db.buscarUsuariosPorRol(i.rolconductor);i.userconductor=a})()}}return(s=e).\u0275fac=function(i){return new(i||s)(t.Y36(g.F0),t.Y36(I.Br),t.Y36(g.gz),t.Y36(w.A))},s.\u0275cmp=t.Xpm({type:s,selectors:[["app-mapa"]],viewQuery:function(i,a){if(1&i&&t.Gf(E,5),2&i){let u;t.iGM(u=t.CRH())&&(a.mapRef=u.first)}},decls:17,vars:5,consts:[[3,"translucent"],[1,"custom-toolbar"],["slot","start"],["defaultHref","/",1,"custom-back-button"],[3,"fullscreen"],["position","stacked"],["type","text",3,"ngModel","ngModelChange"],["id","botonCalculaRuta",3,"click"],["expand","full",3,"click",4,"ngIf"],[4,"ngIf"],[1,"map"],["map",""],["expand","full",3,"click"],[4,"ngFor","ngForOf"]],template:function(i,a){1&i&&(t.TgZ(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-buttons",2),t._UZ(3,"ion-back-button",3),t.qZA(),t.TgZ(4,"ion-title"),t._uU(5,"mapa"),t.qZA()()(),t.TgZ(6,"ion-content",4)(7,"ion-item")(8,"ion-label",5),t._uU(9,"direccion destino"),t.qZA(),t.TgZ(10,"ion-input",6),t.NdJ("ngModelChange",function(f){return a.direccionDestino=f}),t.qZA()(),t.TgZ(11,"ion-button",7),t.NdJ("click",function(){return a.calculaRuta()}),t._uU(12,"Calcular Ruta"),t.qZA(),t.YNc(13,B,2,0,"ion-button",8),t.YNc(14,R,6,2,"ion-card",9),t._UZ(15,"capacitor-google-map",10,11),t.qZA()),2&i&&(t.Q6J("translucent",!0),t.xp6(6),t.Q6J("fullscreen",!0),t.xp6(4),t.Q6J("ngModel",a.direccionDestino),t.xp6(3),t.Q6J("ngIf",2===a.usuarioid),t.xp6(1),t.Q6J("ngIf",a.mostrarinfoconductor))},dependencies:[L.sg,L.O5,C.JJ,C.On,d.YG,d.Sm,d.PM,d.FN,d.Zi,d.W2,d.Gu,d.pK,d.Ie,d.Q$,d.q_,d.wd,d.sr,d.j9,d.oU],styles:["[_ngcontent-%COMP%]:root{--ion-background-color: transparent }body[_ngcontent-%COMP%]{--ion-background-color: transparent }ion-content[_ngcontent-%COMP%]{--background: transparent;--ion-background-color: transparent}.map[_ngcontent-%COMP%]{display:block;width:100%;height:100%}.custom-toolbar[_ngcontent-%COMP%]{--background: #0984e3}.custom-back-button[_ngcontent-%COMP%]{--color: #00b894}"]}),e})()}];let A=(()=>{var s;class e{}return(s=e).\u0275fac=function(i){return new(i||s)},s.\u0275mod=t.oAB({type:s}),s.\u0275inj=t.cJS({imports:[g.Bz.forChild(x),g.Bz]}),e})(),W=(()=>{var s;class e{}return(s=e).\u0275fac=function(i){return new(i||s)},s.\u0275mod=t.oAB({type:s}),s.\u0275inj=t.cJS({imports:[L.ez,C.u5,d.Pc,A]}),e})()}}]);